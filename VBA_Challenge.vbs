Sub ticker()'Making all variablesDim ticker As StringDim ticker_cell As IntegerDim beg_year As DoubleDim end_year As DoubleDim year_change As DoubleDim perc_change As DoubleDim tot_stock As DoubleDim lr As StringDim g_inc As DoubleDim tot_vol As DoubleDim ws As Worksheet'ws loop bonusFor Each ws In ThisWorkbook.Worksheets'setting valuestot_stock = 0lr = Cells(Rows.Count, 1).End(xlUp).Rowticker = ws.Cells(2, 1).Valueticker_cell = 2beg_year = ws.Cells(2, 3).Value'putting names in certain cellsws.Cells(1, 9).Value = "Ticker"ws.Cells(1, 16).Value = "Ticker"ws.Cells(1, 17).Value = "Value"ws.Cells(2, 15).Value = "Greatest % Increase"ws.Cells(3, 15).Value = "Greatest % Decrease"ws.Cells(4, 15).Value = "Greatest Total Volume"ws.Cells(1, 10).Value = "Yearly Change"ws.Cells(1, 11).Value = "Percent Change"ws.Cells(1, 12).Value = "Total Stock Volume"'format percentagesws.Columns("K").NumberFormat = "0.00%"ws.Cells(2, 17).NumberFormat = "0.00%"ws.Cells(3, 17).NumberFormat = "0.00%"For i = 2 To lr    If ticker = ws.Cells(i, 1) Then        tot_stock = tot_stock + ws.Cells(i, 7).Value                Else        end_year = ws.Cells(i - 1, 3).Value        ws.Cells(ticker_cell, 9).Value = ticker        ws.Cells(ticker_cell, 10).Value = end_year - beg_year        ws.Cells(ticker_cell, 11).Value = (end_year - beg_year) / end_year        ws.Cells(ticker_cell, 12).Value = tot_stock        If ws.Cells(ticker_cell, 10).Value < 0 Then            ws.Cells(ticker_cell, 10).Interior.ColorIndex = 3        Else            ws.Cells(ticker_cell, 10).Interior.ColorIndex = 4        End If            'increase        If ws.Cells(ticker_cell, 11).Value > ws.Cells(2, 17).Value Then            ws.Cells(2, 17).Value = ws.Cells(ticker_cell, 11).Value            ws.Cells(2, 16).Value = ws.Cells(ticker_cell, 9).Value        End If            'decrease        If ws.Cells(ticker_cell, 11).Value < ws.Cells(3, 17).Value Then            ws.Cells(3, 17).Value = ws.Cells(ticker_cell, 11).Value            ws.Cells(3, 16).Value = ws.Cells(ticker_cell, 9).Value        End If            'total volume        If ws.Cells(ticker_cell, 12).Value > ws.Cells(4, 17).Value Then                ws.Cells(4, 17).Value = ws.Cells(ticker_cell, 12).Value                ws.Cells(4, 16).Value = ws.Cells(ticker_cell, 9).Value        End If        ticker = ws.Cells(i, 1)        beg_year = ws.Cells(i, 3)        ticker_cell = ticker_cell + 1        tot_stock = 0        End IfNext iNext ws    End Sub