Sub ticker()Dim ticker As StringDim ticker_cell As IntegerDim beg_year As DoubleDim end_year As DoubleDim year_change As DoubleDim perc_change As DoubleDim tot_stock As DoubleDim lr As StringDim g_inc As DoubleDim tot_vol As Doubletot_stock = 0lr = Cells(Rows.Count, 1).End(xlUp).Rowticker = Cells(2, 1)ticker_cell = 2beg_year = Cells(2, 3)Cells(1, 9) = "Ticker"Cells(1, 16) = "Ticker"Cells(1, 17) = "Value"Cells(2, 15) = "Greatest % Increase"Cells(3, 15) = "Greatest % Decrease"Cells(4, 15) = "Greatest Total Volume"Cells(1, 10) = "Yearly Change"Cells(1, 11) = "Percent Change"Cells(1, 12) = "Total Stock Volume"'format percentagesColumns("K").NumberFormat = "0.00%"Cells(2, 17).NumberFormat = "0.00%"Cells(3, 17).NumberFormat = "0.00%"For i = 2 To lr    If ticker = Cells(i, 1) Then        tot_stock = tot_stock + Cells(i, 7)                Else        end_year = Cells(i - 1, 3)        Cells(ticker_cell, 9) = ticker        Cells(ticker_cell, 10) = end_year - beg_year        Cells(ticker_cell, 11) = (end_year - beg_year) / end_year        Cells(ticker_cell, 12) = tot_stock        If Cells(ticker_cell, 10) < 0 Then            Cells(ticker_cell, 10).Interior.ColorIndex = 3        Else            Cells(ticker_cell, 10).Interior.ColorIndex = 4        End If            'increase        If Cells(ticker_cell, 11) > Cells(2, 17) Then            Cells(2, 17) = Cells(ticker_cell, 11)            Cells(2, 16) = Cells(ticker_cell, 9)        End If            'decrease        If Cells(ticker_cell, 11) < Cells(3, 17) Then            Cells(3, 17) = Cells(ticker_cell, 11)            Cells(3, 16) = Cells(ticker_cell, 9)        End If            'total volume        If Cells(ticker_cell, 12) > Cells(4, 17) Then                Cells(4, 17) = Cells(ticker_cell, 12)                Cells(4, 16) = Cells(ticker_cell, 9)        End If        ticker = Cells(i, 1)        beg_year = Cells(i, 3)        ticker_cell = ticker_cell + 1        tot_stock = 0        End IfNext i    End Sub